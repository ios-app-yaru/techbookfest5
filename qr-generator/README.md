# ダウンロードカード用QRコードジェネレーター

このディレクトリには、PDFやEPUBなどの電子書籍ファイルの販売用ダウンロードカードを生成してHTMLページとして印刷できるようにするためのツールが含まれています。HTMLファイルが、ラベル印刷用紙のサイズを想定してCSSでスタイリングされているのが特徴です。

※ラベル用紙は、現時点ではA-ONEの[31511](http://www.a-one.co.jp/product/search/detail.php?id=31511)と[51481](http://www.a-one.co.jp/product/search/detail.php?id=51481)のサポートのみが実装されています（過去にTechBoosterが利用してきたものです）。

このジェネレーターは、具体的には以下のステップでQRコードシートを生成します:

- 頒布するファイルのコピー数の分だけ、ダウンロードファイルのURLに含めるランダム文字列を生成し、それをファイル名に追加してローカルディレクトリに(大量に)コピーする
  - ローカルディレクトリは、Dropboxで作成できるアプリケーション フォルダを想定しています。それ以外のサービス等でファイルを同期する場合は、それぞれの環境に合わせて行ってください。
- ローカルファイル名をもとに、Dropbox APIを使用してDropbox上の公開URLを生成する
  - 公開URLを生成するには、Dropboxのサーバ上にファイルが存在している必要があります。Dropboxへのファイル転送が完了してからでないと、この処理は成功しません。qr-generator.shでは、ファイルの転送終了を確認するようダイアログが表示されます。
- Dropbox APIから、生成したダウンロード用リンクのリストをJSONで取得する
- ダウンロードしたJSONから、個別のダウンロード用URLの部分を全て取得して、連番を振りながらCSVファイルに列挙する
- CSVファイルの各行について、qrencodeを実行してQRコードの画像ファイルを生成してローカルに保存しつつ、そのファイル名などを含むJSONファイルを生成する

QRコードはこれで生成されています。生成されているQRコードは次のステップで印刷します。

- ブラウザで、使用したいラベル用紙に対応するHTMLファイルを開きます
  - 例: A-ONE 31511なら31511.html
- ファイル選択ボタンを押して、上記ステップの最後に生成されたJSONファイルを開きます
- ブラウザの「印刷」コマンドで印刷します。

※注意

イベント前日や当日になってKinko'sなどに駆け込んでこのQRコードを印刷するようなこともあるかと思いますが、これらのサービスではプリンターの設定として、用紙のマージンサイズが固定されていて変更できないことがあります。ラベル用紙への印刷を依頼する前に、必ずHTMLおよびCSSでマージンサイズを調整しましょう。

